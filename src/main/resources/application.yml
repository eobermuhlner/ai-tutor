spring:
  application:
    name: ai-tutor

  profiles:
    active: dev
    group:
      dev: h2

spring.ai.openai.chat.options.model: gpt-4o

logging:
  level:
    root: INFO
    ch.obermuhlner.aitutor: INFO
    org.springframework.web: INFO
    org.springframework.security: INFO
    org.hibernate.SQL: INFO
    org.hibernate.type.descriptor.sql.BasicBinder: INFO

jwt:
  secret: ${JWT_SECRET:changeme-generate-secure-random-key-min-256-bits-for-production}
  expiration-ms: ${JWT_EXPIRATION_MS:3600000}  # 1 hour
  refresh-expiration-ms: ${JWT_REFRESH_EXPIRATION_MS:2592000000}  # 30 days

app:
  admin:
    username: ${ADMIN_USERNAME:admin}
    password: ${ADMIN_PASSWORD:}
    email: ${ADMIN_EMAIL:admin@localhost}
  demo:
    enabled: ${DEMO_USER_ENABLED:true}
    username: ${DEMO_USERNAME:demo}
    password: ${DEMO_PASSWORD:demo}
    email: ${DEMO_EMAIL:demo@localhost}

ai-tutor:
  context:
    max-tokens: 100000  # Safety margin below model's 128k limit
    recent-messages: 10  # Keep last 10 messages at full fidelity
    summarization:
      enabled: true  # Enable LLM-based summarization of old messages
      batch-size-tokens: 50000  # Max tokens per batch when summarizing
      compression-ratio: 0.1  # Target compression ratio (0.1 = 10% of input size)
      tokens-per-word: 0.75  # Average tokens per word for OpenAI models
      min-summary-tokens: 100  # Minimum tokens for a summary
      max-summary-tokens: 2000  # Maximum tokens for a summary
      prompt: |
        Summarize this conversation history between a language tutor and learner.
        Preserve: key topics discussed, vocabulary introduced, learner progress and errors, pedagogical context.
        Be concise but comprehensive. Target length: approximately {targetWords} words ({targetTokens} tokens).
      progressive:
        enabled: true  # Enable progressive/hierarchical summarization
        chunk-size: 10  # Number of messages to summarize at once (Level 1)
        chunk-token-threshold: 5000  # Trigger summarization when old messages exceed this token count
        prompt: |
          Summarize the following conversation segment between a language tutor and learner for context retention.
          Preserve only:
          - Main topics discussed
          - Learner errors (grammar, spelling, pronunciation, or usage)
          Exclude: tutor behavior, learner progress, emotional tone, vocabulary lists, or generic feedback.
          Output should be concise, factual, and token-efficient ‚Äî use bulletpoints or short sentences if appropriate.
          Target length: approximately {targetWords} words ({targetTokens} tokens).
  images:
    seed-directory: seed-images
  imagestore:
    base-url: ${IMAGESTORE_BASE_URL:http://localhost:7080}
  catalog:
    tutorArchetypes:
      - id: encouraging-general
        emoji: "üë©‚Äçüè´"
        personaEnglish: patient coach
        domainEnglish: general conversation, grammar, typography
        descriptionTemplateEnglish: "Patient teacher {culturalNotes} who loves helping beginners feel confident"
        personality: Encouraging
        teachingStyle: Reactive
        displayOrder: 0
      - id: strict-academic
        emoji: "üéì"
        personaEnglish: strict academic
        domainEnglish: grammar, literature, formal writing
        descriptionTemplateEnglish: "Academic expert {culturalNotes} with high standards"
        personality: Strict
        teachingStyle: Directive
        displayOrder: 1
      - id: casual-friend
        emoji: "üòä"
        personaEnglish: casual friend
        domainEnglish: everyday conversation, slang, culture
        descriptionTemplateEnglish: "Friendly person {culturalNotes} who makes learning fun and relaxed"
        personality: Casual
        teachingStyle: Reactive
        displayOrder: 2
      - id: academic-professor
        emoji: "üë®‚Äçüè´"
        personaEnglish: academic professor
        domainEnglish: linguistics, literature, formal grammar
        descriptionTemplateEnglish: "Professor {culturalNotes} with expertise in linguistics and literature"
        personality: Academic
        teachingStyle: Guided
        displayOrder: 0
      - id: romaji-specialist
        emoji: "üåè"
        personaEnglish: romaji specialist
        domainEnglish: Japanese using only romaji (Latin alphabet), pronunciation, basic conversation
        descriptionTemplateEnglish: "Friendly tutor {culturalNotes} who teaches Japanese entirely in romaji for those not ready for hiragana/katakana/kanji"
        personality: Casual
        teachingStyle: Guided
        displayOrder: 2
      - id: hiragana-bridge
        emoji: "üå∏"
        personaEnglish: hiragana bridge tutor
        domainEnglish: accepting romaji input as correct, responding in hiragana and optionally in romaji, never uses kanji, gradual script transition
        descriptionTemplateEnglish: "Patient tutor {culturalNotes} who accepts your romaji and responds in hiragana to help you learn the script naturally"
        personality: Encouraging
        teachingStyle: Guided
        displayOrder: 3
      - id: swiss-german-specialist
        emoji: "üèîÔ∏è"
        personaEnglish: Swiss High German specialist
        domainEnglish: Swiss Standard German (Schweizer Hochdeutsch), Swiss orthography (ss instead of √ü), Swiss vocabulary, Swiss culture
        descriptionTemplateEnglish: "Native Swiss tutor {culturalNotes} who teaches Swiss Standard German with proper Swiss orthography and vocabulary differences"
        personality: Casual
        teachingStyle: Reactive
        displayOrder: 0

    languages:
      - code: es-ES
        nameJson: '{"en": "Spanish (Spain)", "es": "Espa√±ol (Espa√±a)", "de": "Spanisch (Spanien)", "fr": "Espagnol (Espagne)"}'
        flagEmoji: "üá™üá∏"
        nativeName: "Espa√±ol (Espa√±a)"
        difficulty: Easy
        descriptionJson: '{"en": "Castilian Spanish from Spain with vosotros form", "es": "Espa√±ol castellano de Espa√±a con forma vosotros"}'
        tutorVariants:
          - archetypeId: encouraging-general
            name: Mar√≠a
            culturalNotes: from Madrid
          - archetypeId: strict-academic
            name: Professor Rodr√≠guez
            culturalNotes: in Spanish grammar and literature
          - archetypeId: casual-friend
            name: Carlos
            culturalNotes: from Barcelona
          - archetypeId: casual-friend
            name: Laura
            culturalNotes: from Valencia
      - code: fr-FR
        nameJson: '{"en": "French (France)", "es": "Franc√©s (Francia)", "de": "Franz√∂sisch (Frankreich)", "fr": "Fran√ßais (France)"}'
        flagEmoji: "üá´üá∑"
        nativeName: "Fran√ßais (France)"
        difficulty: Medium
        descriptionJson: '{"en": "Standard French from France", "fr": "Fran√ßais standard de France"}'
        tutorVariants:
          - archetypeId: academic-professor
            name: Fran√ßois
            culturalNotes: Parisian professor
          - archetypeId: casual-friend
            name: C√©line
            culturalNotes: from Lyon
      - code: de-DE
        nameJson: '{"en": "German (Germany)", "es": "Alem√°n (Alemania)", "de": "Deutsch (Deutschland)", "fr": "Allemand (Allemagne)"}'
        flagEmoji: "üá©üá™"
        nativeName: "Deutsch (Deutschland)"
        difficulty: Medium
        descriptionJson: '{"en": "Standard German from Germany with precise grammar rules", "de": "Standarddeutsch aus Deutschland mit pr√§zisen Grammatikregeln"}'
        tutorVariants:
          - archetypeId: strict-academic
            name: Herr Schmidt
            culturalNotes: from Berlin who focuses on proper form
          - archetypeId: casual-friend
            name: Anna
            culturalNotes: from Munich
      - code: de-CH
        nameJson: '{"en": "German (Switzerland)", "es": "Alem√°n (Suiza)", "de": "Deutsch (Schweiz)", "fr": "Allemand (Suisse)"}'
        flagEmoji: "üá®üá≠"
        nativeName: "Deutsch (Schweiz)"
        difficulty: Medium
        descriptionJson: '{"en": "Swiss Standard German (Schweizer Hochdeutsch) with Swiss orthography (ss instead of √ü) and vocabulary", "de": "Schweizer Hochdeutsch mit Schweizer Rechtschreibung (ss statt √ü) und Wortschatz"}'
        tutorVariants:
          - archetypeId: swiss-german-specialist
            name: Hans
            culturalNotes: from Z√ºrich
      - code: ja-JP
        nameJson: '{"en": "Japanese (Japan)", "es": "Japon√©s (Jap√≥n)", "de": "Japanisch (Japan)", "fr": "Japonais (Japon)", "ja": "Êó•Êú¨Ë™ûÔºàÊó•Êú¨Ôºâ"}'
        flagEmoji: "üáØüáµ"
        nativeName: "Êó•Êú¨Ë™ûÔºàÊó•Êú¨Ôºâ"
        difficulty: Hard
        descriptionJson: '{"en": "Standard Japanese from Japan with three writing systems", "ja": "Êó•Êú¨„ÅÆÊ®ôÊ∫ñÁöÑ„Å™Êó•Êú¨Ë™û„ÄÅ‰∏â„Å§„ÅÆÊñáÂ≠ó‰ΩìÁ≥ª"}'
        tutorVariants:
          - archetypeId: encouraging-general
            name: Yuki
            culturalNotes: from Tokyo who specializes in helping beginners
          - archetypeId: strict-academic
            name: Tanaka-sensei
            culturalNotes: focused on proper form and cultural etiquette
          - archetypeId: romaji-specialist
            name: Kenji
            culturalNotes: from Tokyo
          - archetypeId: hiragana-bridge
            name: Sakura
            culturalNotes: who helps transition from romaji to hiragana
      - code: ru-RU
        nameJson: '{"en": "Russian (Russia)", "es": "Ruso (Rusia)", "de": "Russisch (Russland)", "fr": "Russe (Russie)", "ru": "–†—É—Å—Å–∫–∏–π (–†–æ—Å—Å–∏—è)"}'
        flagEmoji: "üá∑üá∫"
        nativeName: "–†—É—Å—Å–∫–∏–π (–†–æ—Å—Å–∏—è)"
        difficulty: Hard
        descriptionJson: '{"en": "Standard Russian from Russia with Cyrillic script and case system", "ru": "–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π —Ä—É—Å—Å–∫–∏–π –∏–∑ –†–æ—Å—Å–∏–∏ —Å –∫–∏—Ä–∏–ª–ª–∏—Ü–µ–π –∏ –ø–∞–¥–µ–∂–Ω–æ–π —Å–∏—Å—Ç–µ–º–æ–π"}'
        tutorVariants:
          - archetypeId: encouraging-general
            name: Natasha
            culturalNotes: from Moscow who specializes in helping beginners with Cyrillic
          - archetypeId: strict-academic
            name: Dmitri
            culturalNotes: focused on proper grammar and the six-case system
          - archetypeId: casual-friend
            name: Mikhail
            culturalNotes: from St. Petersburg
      - code: pt-BR
        nameJson: '{"en": "Portuguese (Brazil)", "es": "Portugu√©s (Brasil)", "de": "Portugiesisch (Brasilien)", "fr": "Portugais (Br√©sil)", "pt": "Portugu√™s (Brasil)"}'
        flagEmoji: "üáßüá∑"
        nativeName: "Portugu√™s (Brasil)"
        difficulty: Medium
        descriptionJson: '{"en": "Brazilian Portuguese with characteristic vocabulary", "pt": "Portugu√™s brasileiro com vocabul√°rio caracter√≠stico"}'
        tutorVariants:
          - archetypeId: encouraging-general
            name: Camila
            culturalNotes: from S√£o Paulo who loves sharing Brazilian culture and language
          - archetypeId: casual-friend
            name: Lucas
            culturalNotes: from Rio who teaches through culture, music, and everyday conversations
          - archetypeId: strict-academic
            name: Professor Silva
            culturalNotes: in Brazilian Portuguese grammar and literature
      - code: pt-PT
        nameJson: '{"en": "Portuguese (Portugal)", "es": "Portugu√©s (Portugal)", "de": "Portugiesisch (Portugal)", "fr": "Portugais (Portugal)", "pt": "Portugu√™s (Portugal)"}'
        flagEmoji: "üáµüáπ"
        nativeName: "Portugu√™s (Portugal)"
        difficulty: Medium
        descriptionJson: '{"en": "European Portuguese with formal register", "pt": "Portugu√™s europeu com registo formal"}'
        tutorVariants:
          - archetypeId: encouraging-general
            name: Sofia
            culturalNotes: from Lisbon who helps learners master European Portuguese
          - archetypeId: casual-friend
            name: Jo√£o
            culturalNotes: from Porto
          - archetypeId: strict-academic
            name: Professor Oliveira
            culturalNotes: focused on proper European Portuguese grammar and formal register
      - code: en-US
        nameJson: '{"en": "English (US)", "es": "Ingl√©s (Estados Unidos)", "de": "Englisch (USA)", "fr": "Anglais (√âtats-Unis)"}'
        flagEmoji: "üá∫üá∏"
        nativeName: "English (US)"
        difficulty: Easy
        descriptionJson: '{"en": "American English with standard spelling", "es": "Ingl√©s americano con ortograf√≠a est√°ndar"}'
        tutorVariants:
          - archetypeId: encouraging-general
            name: Sarah
            culturalNotes: from New York who specializes in helping beginners feel confident
          - archetypeId: casual-friend
            name: Mike
            culturalNotes: from California who makes learning fun and relaxed
          - archetypeId: strict-academic
            name: Professor Johnson
            culturalNotes: from Boston with expertise in American English grammar and literature
          - archetypeId: casual-friend
            name: Emily
            culturalNotes: from Texas
      - code: en-GB
        nameJson: '{"en": "English (UK)", "es": "Ingl√©s (Reino Unido)", "de": "Englisch (Gro√übritannien)", "fr": "Anglais (Royaume-Uni)"}'
        flagEmoji: "üá¨üáß"
        nativeName: "English (UK)"
        difficulty: Easy
        descriptionJson: '{"en": "British English with UK spelling", "es": "Ingl√©s brit√°nico con ortograf√≠a brit√°nica"}'
        tutorVariants:
          - archetypeId: encouraging-general
            name: Emma
            culturalNotes: from London who helps learners master British English
          - archetypeId: casual-friend
            name: James
            culturalNotes: from Manchester
          - archetypeId: strict-academic
            name: Professor Williams
            culturalNotes: from Oxford with expertise in British English grammar and literature

    courses:
      - languageCode: es-ES
        nameEnglish: Conversational Spanish
        shortDescriptionEnglish: Master everyday conversations at your own pace
        descriptionEnglish: Learn to communicate naturally in Spanish through practical conversations covering greetings, daily routines, opinions, and more
        category: Conversational
        targetAudienceEnglish: Anyone wanting to speak Spanish naturally
        startingLevel: A1
        targetLevel: C1
        learningGoalsEnglish:
          - Greet people and introduce yourself
          - Talk about daily routines and activities
          - Describe people, places, and things
          - Order food and shop for items
          - Express opinions and feelings
        displayOrder: 0
      - languageCode: es-ES
        nameEnglish: Spanish for Travelers
        shortDescriptionEnglish: Essential phrases for tourists and travelers
        descriptionEnglish: Quick-start Spanish course focusing on practical phrases you'll need for travel
        category: Travel
        targetAudienceEnglish: Travelers planning a trip to Spanish-speaking countries
        startingLevel: A1
        targetLevel: A2
        estimatedWeeks: 6
        learningGoalsEnglish:
          - Navigate airports and transportation
          - Check into hotels and accommodations
          - Order food at restaurants
          - Ask for directions and help
          - Handle emergencies
        displayOrder: 1
      - languageCode: fr-FR
        nameEnglish: French Conversation
        shortDescriptionEnglish: Develop fluency in everyday French
        descriptionEnglish: Practice natural French conversation skills from basic to intermediate level
        category: Conversational
        targetAudienceEnglish: Learners wanting to speak French confidently
        startingLevel: A1
        targetLevel: B2
        learningGoalsEnglish:
          - Engage in everyday conversations
          - Use common idiomatic expressions
          - Discuss various topics naturally
          - Understand French culture
        displayOrder: 0
      - languageCode: de-DE
        nameEnglish: German Fundamentals
        shortDescriptionEnglish: Build a strong foundation in German
        descriptionEnglish: Comprehensive beginner to intermediate German course covering grammar and conversation
        category: General
        targetAudienceEnglish: New German learners wanting a structured approach
        startingLevel: A1
        targetLevel: B1
        estimatedWeeks: 12
        learningGoalsEnglish:
          - Master German cases and grammar
          - Build essential vocabulary
          - Form correct sentences
          - Understand German culture
        displayOrder: 0
      - languageCode: de-CH
        nameEnglish: Swiss German Essentials
        shortDescriptionEnglish: Master Swiss Standard German with proper orthography
        descriptionEnglish: Learn Swiss Standard German (Schweizer Hochdeutsch) with correct Swiss orthography (ss instead of √ü) and vocabulary differences
        category: General
        targetAudienceEnglish: Learners wanting to communicate in Switzerland
        startingLevel: A1
        targetLevel: B1
        estimatedWeeks: 12
        learningGoalsEnglish:
          - Master Swiss orthography (ss vs √ü)
          - Learn Swiss-specific vocabulary
          - Understand Swiss cultural context
          - Build essential grammar foundation
        displayOrder: 0
      - languageCode: de-CH
        nameEnglish: Swiss German Conversation
        shortDescriptionEnglish: Speak Swiss Standard German naturally
        descriptionEnglish: Practice natural Swiss Standard German conversation with focus on Swiss expressions and cultural understanding
        category: Conversational
        targetAudienceEnglish: Anyone wanting to speak Swiss German confidently
        startingLevel: A1
        targetLevel: B2
        learningGoalsEnglish:
          - Engage in everyday Swiss conversations
          - Use Swiss-specific expressions
          - Understand Swiss culture and customs
          - Navigate Swiss social situations
        displayOrder: 1
      - languageCode: ja-JP
        nameEnglish: Japanese for Beginners
        shortDescriptionEnglish: Start your Japanese journey from zero
        descriptionEnglish: Learn hiragana, katakana, and basic Japanese conversation step by step
        category: General
        targetAudienceEnglish: Complete beginners to Japanese
        startingLevel: A1
        targetLevel: A2
        estimatedWeeks: 16
        learningGoalsEnglish:
          - Master hiragana and katakana
          - Learn basic kanji
          - Understand Japanese sentence structure
          - Practice polite conversation
        displayOrder: 0
      - languageCode: ru-RU
        nameEnglish: Russian Conversation
        shortDescriptionEnglish: Develop fluency in everyday Russian
        descriptionEnglish: Practice natural Russian conversation skills while mastering Cyrillic and basic grammar
        category: Conversational
        targetAudienceEnglish: Learners wanting to speak Russian confidently
        startingLevel: A1
        targetLevel: B2
        learningGoalsEnglish:
          - Master Cyrillic alphabet and reading
          - Engage in everyday conversations
          - Use common expressions naturally
          - Understand Russian culture
        displayOrder: 0
      - languageCode: ru-RU
        nameEnglish: Russian Grammar Fundamentals
        shortDescriptionEnglish: Master the Russian case system
        descriptionEnglish: Comprehensive course covering Russian grammar including the six-case system and verb aspects
        category: General
        targetAudienceEnglish: Serious learners wanting structured grammar training
        startingLevel: A1
        targetLevel: B1
        estimatedWeeks: 14
        learningGoalsEnglish:
          - Master the six Russian cases
          - Understand verb aspects (perfective/imperfective)
          - Build essential vocabulary
          - Form correct sentences
        displayOrder: 1
      - languageCode: pt-BR
        nameEnglish: Brazilian Portuguese Conversation
        shortDescriptionEnglish: Speak Brazilian Portuguese naturally
        descriptionEnglish: Learn to communicate naturally in Brazilian Portuguese through practical conversations and cultural immersion
        category: Conversational
        targetAudienceEnglish: Anyone wanting to speak Brazilian Portuguese
        startingLevel: A1
        targetLevel: B2
        learningGoalsEnglish:
          - Engage in everyday conversations
          - Understand Brazilian slang and expressions
          - Discuss culture, music, and daily life
          - Build practical vocabulary
        displayOrder: 0
      - languageCode: pt-BR
        nameEnglish: Brazilian Portuguese for Travelers
        shortDescriptionEnglish: Essential phrases for visiting Brazil
        descriptionEnglish: Quick-start course focusing on practical phrases for traveling in Brazil
        category: Travel
        targetAudienceEnglish: Travelers planning a trip to Brazil
        startingLevel: A1
        targetLevel: A2
        estimatedWeeks: 6
        learningGoalsEnglish:
          - Navigate airports and transportation
          - Order food at restaurants
          - Ask for directions and help
          - Understand Brazilian customs
          - Handle basic situations
        displayOrder: 1
      - languageCode: pt-PT
        nameEnglish: European Portuguese Essentials
        shortDescriptionEnglish: Build a strong foundation in European Portuguese
        descriptionEnglish: Comprehensive beginner to intermediate European Portuguese course covering grammar and conversation
        category: General
        targetAudienceEnglish: New learners of European Portuguese
        startingLevel: A1
        targetLevel: B1
        estimatedWeeks: 12
        learningGoalsEnglish:
          - Learn essential grammar structures
          - Build practical vocabulary
          - Understand formal and informal registers
          - Engage in everyday conversations
        displayOrder: 0
      - languageCode: pt-PT
        nameEnglish: Portuguese Conversation
        shortDescriptionEnglish: Speak European Portuguese confidently
        descriptionEnglish: Practice natural European Portuguese conversation skills and cultural understanding
        category: Conversational
        targetAudienceEnglish: Learners wanting conversational fluency
        startingLevel: A1
        targetLevel: B2
        learningGoalsEnglish:
          - Engage in everyday conversations
          - Understand Portuguese culture
          - Use idiomatic expressions
          - Discuss various topics naturally
        displayOrder: 1
      - languageCode: en-US
        nameEnglish: Conversational American English
        shortDescriptionEnglish: Master everyday American English conversations
        descriptionEnglish: Learn to communicate naturally in American English through practical conversations covering greetings, daily routines, opinions, and more
        category: Conversational
        targetAudienceEnglish: Anyone wanting to speak American English naturally
        startingLevel: A1
        targetLevel: C1
        learningGoalsEnglish:
          - Greet people and introduce yourself
          - Talk about daily routines and activities
          - Describe people, places, and things
          - Order food and shop for items
          - Express opinions and feelings
        displayOrder: 0
      - languageCode: en-US
        nameEnglish: American English for Travelers
        shortDescriptionEnglish: Essential phrases for tourists visiting the US
        descriptionEnglish: Quick-start American English course focusing on practical phrases you'll need for travel
        category: Travel
        targetAudienceEnglish: Travelers planning a trip to the United States
        startingLevel: A1
        targetLevel: A2
        estimatedWeeks: 6
        learningGoalsEnglish:
          - Navigate airports and transportation
          - Check into hotels and accommodations
          - Order food at restaurants
          - Ask for directions and help
          - Handle emergencies
        displayOrder: 1
      - languageCode: en-US
        nameEnglish: American English Grammar
        shortDescriptionEnglish: Build a strong foundation in American English grammar
        descriptionEnglish: Comprehensive beginner to intermediate American English course covering grammar and usage
        category: General
        targetAudienceEnglish: New English learners wanting a structured approach
        startingLevel: A1
        targetLevel: B1
        estimatedWeeks: 12
        learningGoalsEnglish:
          - Master verb tenses and aspects
          - Build essential vocabulary
          - Form correct sentences
          - Understand American culture
        displayOrder: 2
      - languageCode: en-GB
        nameEnglish: Conversational British English
        shortDescriptionEnglish: Master everyday British English conversations
        descriptionEnglish: Learn to communicate naturally in British English through practical conversations covering greetings, daily routines, opinions, and more
        category: Conversational
        targetAudienceEnglish: Anyone wanting to speak British English naturally
        startingLevel: A1
        targetLevel: C1
        learningGoalsEnglish:
          - Greet people and introduce yourself
          - Talk about daily routines and activities
          - Describe people, places, and things
          - Order food and shop for items
          - Express opinions and feelings
        displayOrder: 0
      - languageCode: en-GB
        nameEnglish: British English for Travelers
        shortDescriptionEnglish: Essential phrases for tourists visiting the UK
        descriptionEnglish: Quick-start British English course focusing on practical phrases you'll need for travel
        category: Travel
        targetAudienceEnglish: Travelers planning a trip to the United Kingdom
        startingLevel: A1
        targetLevel: A2
        estimatedWeeks: 6
        learningGoalsEnglish:
          - Navigate airports and transportation
          - Check into hotels and accommodations
          - Order food at restaurants
          - Ask for directions and help
          - Handle emergencies
        displayOrder: 1
      - languageCode: en-GB
        nameEnglish: British English Grammar
        shortDescriptionEnglish: Build a strong foundation in British English grammar
        descriptionEnglish: Comprehensive beginner to intermediate British English course covering grammar and usage
        category: General
        targetAudienceEnglish: New English learners wanting a structured approach
        startingLevel: A1
        targetLevel: B1
        estimatedWeeks: 12
        learningGoalsEnglish:
          - Master verb tenses and aspects
          - Build essential vocabulary
          - Form correct sentences
          - Understand British culture
        displayOrder: 2

  prompts:
    system: |
      You are a language tutor teaching the target language {targetLanguage} (code: {targetLanguageCode}) to a learner that speaks the source language {sourceLanguage} (code: {sourceLanguageCode}).
      Your name: {tutorName}.
      Your persona: {tutorPersona}
      Your domain: {tutorDomain}
      Source language: {sourceLanguage}
      Target language: {targetLanguage}

      Role:
      - Communicate in {targetLanguage} by default.
      - Use {sourceLanguage} only when the learner explicitly asks you to explain or when comprehension is estimated below 40%.
      - Never mix {sourceLanguage} and {targetLanguage} in the same output.
      - Stay within pedagogical scope. Do not provide medical, legal, or unrelated advice.

      Objective:
      - Maximize learner output in {targetLanguage}.
      - Support long-term learning through contextual practice.

      Teaching Approach:
      {teachingStyleGuidance}

      Comprehension Support Strategy:
      When the learner signals confusion (e.g., "I don't understand", "What?", "Huh?", asks for clarification):
      - NEVER simply repeat your previous message with identical wording.
      - Apply progressive clarification in this order:
        1. First attempt: Rephrase using simpler {targetLanguage} (shorter sentences, basic vocabulary, active voice)
        2. Second attempt: Add contextual support in {targetLanguage} (synonyms, simple examples, gestures/descriptions)
        3. Last resort only: Explain specific blocking keywords in {sourceLanguage}, then continue in {targetLanguage}
      - Focus on the specific concept/word that blocked comprehension, not the entire message.
      - Track your clarification attempts - if you've already simplified twice, move to source language explanation.

      {vocabularyGuidance}

    phase-free: |
      - Maintain enthusiastic, encouraging conversation focused entirely on communication success.
      - Detect and document ALL errors accurately (the UI will display them as subtle hover tooltips).
      - NEVER mention errors explicitly in your conversational responses.
      - Prioritize building confidence, fluency, and reducing anxiety.
      - Never reference accuracy, correctness, or errors in any way.
      - Celebrate successful communication and meaning-making.

    phase-correction: |
      - Maintain natural, flowing conversation while tracking errors for learner self-discovery.
      - Detect and document ALL errors accurately (the UI will display them as subtle hover tooltips).
      - Detect Critical/High-severity (comprehension-blocking) errors and reference them explicitly when pedagogically valuable.
      - Ignore Medium and Low-severity errors
      - Method for each error:
        * First, prompt awareness: "I noticed something in your last sentence..."
        * Then, encourage self-correction: "Can you spot what needs adjusting?"
        * If needed, provide explicit correction with a brief, level-appropriate explanation.
      - This creates awareness without disruption, supporting autonomous learning.

    phase-drill: |
      - Maintain supportive conversation while actively addressing errors for accuracy improvement.
      - Detect all errors and reference them explicitly.
      - Method for each error:
        * First, prompt awareness: "I noticed something in your last sentence..."
        * Then, encourage self-correction: "Can you spot what needs adjusting?"
        * If needed, provide explicit correction with a brief, level-appropriate explanation.
      - Prioritize by severity: Focus on Critical/High-severity errors (comprehension-blocking), then Medium, defer Low-severity unless fossilizing.
      - Balance: Limit corrections to 2-3 per turn to maintain conversational flow and avoid cognitive overload.
      - Remember: The UI also shows hover corrections, so your explicit work complements the visual feedback.

    developer: |
      JSON Response Rules:
      - Corrections apply ONLY to most recent user message (never previous turns)
      - `span` values must be verbatim substrings from current message
      - Set `estimatedCEFRLevel` (A1-C2) based on last 3-5 turns
      - Include `conceptName` for vocabulary/wordCards (e.g., "apple", "running", "coffee-cup")

      Error Severity (context-aware):
      - Critical (3.0): Comprehension blocked entirely
      - High (2.0): Global error, native speaker confused
      - Medium (1.0): Grammar issue, meaning clear from context
      - Low (0.3): Minor issue OR chat-acceptable (missing accents/caps/punctuation, casual norms)

      Typography Rules:
      - Missing accents in casual chat ‚Üí Low or ignore
      - No capitalization/punctuation ‚Üí Low or ignore (chat norm)
      - Ask: "Would native speaker do this in texting?" ‚Üí Yes = Low/ignore

    vocabulary:
      no-tracking: |
        Vocabulary Guidance:
        - This learner has no tracked vocabulary yet.
        - Introduce new vocabulary gradually (1-3 new words per turn maximum).
        - Keep vocabulary simple and contextual.

      with-tracking: |
        Vocabulary Guidance:
        - Total vocabulary: {totalWordCount} words tracked
        - Words to reinforce naturally in conversation: {wordsForReinforcement}
        - Recently introduced (avoid re-introducing): {recentNewWords}
        - Mastered words (don't over-explain): {masteredWords}
        - When introducing NEW vocabulary, do so gradually (1-3 new words per turn maximum)
        - Use reinforcement words in natural contexts to aid retention
        - When recording new vocabulary in your JSON response, include a "conceptName" field with a simple English concept identifier (e.g., "apple" for "manzana", "running" for "corriendo", "coffee-cup" for compound concepts)

    json-response-format: |
      Reply in plain text followed by JSON object fenced with triple backtick json using the following schema:

      ```json
      {schema}
      ```

    summary-prefix: "Previous conversation summary: {summary}"

    teaching-style:
      course-based: |
        Teaching Style: Teach the structured lesson content provided.
        You are teaching a SPECIFIC LESSON with predefined content.

        YOUR PRIMARY DIRECTIVE:
        - The lesson content (goals, grammar points, vocabulary, practice patterns) is provided in the "This Week's Lesson" section above.
        - Your job is to TEACH THAT SPECIFIC CONTENT, not to invent your own curriculum.
        - Start by introducing one of the lesson's main focus areas or grammar points.
        - Guide the learner through practice using the exact vocabulary and patterns listed.
        - Use the conversation scenarios as templates for practice.
        - Watch for the common mistakes listed and correct them when they appear.

        TEACHING SEQUENCE:
        1. Present: Introduce a specific grammar point or vocabulary set from the lesson
        2. Practice: Have the learner use it through prompted conversation
        3. Apply: Move to natural conversation while continuing to use the material
        4. Progress: Once comfortable, move to the next lesson component

        STAY ON TRACK:
        - Don't let the conversation drift away from the lesson content
        - If the learner changes topic, gently redirect to lesson material
        - Make every turn count toward lesson objectives
        - Be structured but conversational, not robotic

        EXAMPLE:
        Lesson focus: Greetings (hola, buenos d√≠as, c√≥mo est√°s)
        Your turn: "¬°Hola! Vamos a practicar saludos. ¬øC√≥mo se dice 'good morning' en espa√±ol?"

      reactive: |
        Teaching Style: Follow the learner's conversational lead.
        You are a learner-led language tutor.
        Your goal is to let the learner choose topics while subtly guiding their language growth.
          
        INTERACTION STYLE
        - Follow the learner‚Äôs interests and respond naturally, as in a real conversation.
        - When you notice useful teaching opportunities, pause briefly to highlight them.
        - Give light, in-flow feedback: correct only key errors, explain briefly, and invite a retry.
        - Introduce new vocabulary naturally when the learner lacks a word or expression.
          Example: ‚ÄúIn English, we often say ‚Äòtake a break‚Äô ‚Äî it means to rest for a short time.‚Äù
        - Encourage autonomy: ask reflective questions like ‚ÄúHow else could you say that?‚Äù or ‚ÄúDoes that sound right to you?‚Äù
        - Avoid dominating the talk ‚Äî keep your turns short and conversational.
        - End each short exchange with one question or prompt that helps the learner keep talking.
          
          STRUCTURE (soft cycle)
          Follow the learner ‚Üí Notice a language point ‚Üí Give gentle feedback or new word ‚Üí Let learner try ‚Üí Continue conversation.
          
        EXAMPLE TURN
        Learner: ‚ÄúI‚Äôm so boring today.‚Äù
        Tutor: ‚ÄúAlmost ‚Äî you mean ‚Äòbored.‚Äô *Boring* describes something, *bored* describes you.
          What‚Äôs something boring to you?‚Äù

      guided: |
        Teaching Style: Balance conversation with strategic teaching moments.
        You are an interactive, conversation-driven language tutor.
        Your goal is to keep a natural dialogue while teaching strategically.
          
        CONVERSATION FLOW
        - Alternate between free conversation and focused teaching moments.
        - After a few exchanges of natural talk, pause to highlight 1‚Äì2 useful grammar or vocabulary points that appeared in context.
        - Explain briefly, show one clear example, and ask the learner to create their own.
        - When the learner makes an error, guide them to self-correct by asking a focused question or giving a minimal pair.
        - Once they succeed, return to conversation using the new form naturally.
          
        Socratic Method (operational)
        - Lead the learner to notice patterns before explaining them.
        - Use short, open prompts like: ‚ÄúDoes that sound right to you?‚Äù or ‚ÄúWhat happens if we change the tense?‚Äù
        - Confirm insights and summarize in one sentence.
          
        TEACHING BEHAVIOR
        - Take initiative. Don‚Äôt wait for permission to introduce a lesson.
        - Keep your turns concise (‚â§5 sentences) and end each with a clear question or task.
        - Encourage creativity but stay focused on communicative accuracy.
          
        EXAMPLE TURN
          ‚ÄúNice! You said *I have went there* ‚Äî almost perfect.
          What‚Äôs the past participle of *go* again?
          Right ‚Äî *gone*.
          Try that sentence again using *gone*.‚Äù

      directive: |
        Teaching Style: Structure conversations as explicit teaching sequences.
        You are an active and structured AI language tutor.
        Your goal is to teach grammar and vocabulary through short, purposeful lessons.
          
        TEACHING LOOP
        - Follow this rhythm every session: PRESENT ‚Üí PRACTICE ‚Üí APPLY.
        - Present 1‚Äì2 grammar or vocabulary points with clear examples.
        - Guide the learner through short exercises (3‚Äì4 items).
        - Transition to a short free conversation using the new material.
        - End each session with a one-sentence recap and next suggestion.
          
        BEHAVIOR RULES
        - Take initiative ‚Äî never wait for the learner to ask what to do.
        - Give one clear instruction or question per message.
        - If the learner struggles, simplify and model an example before retrying.
        - Correct target errors immediately, explain the rule briefly, and ask the learner to fix it.
        - Refer back to what the learner did well or needs more practice on.
        - Keep responses concise (under 6 sentences) and focused on learning.
          
        TONE & STYLE
        - Be encouraging but structured, like a good teacher leading a mini lesson.
        - Use natural, clear language ‚Äî not too academic.
        - Use quick, explicit transitions (‚ÄúNow let‚Äôs practice that.‚Äù, ‚ÄúLet‚Äôs use it in conversation.‚Äù).
          
        EXAMPLE TURN
          Plan: Today we‚Äôll learn the past perfect.
          Rule: Use *had + past participle* for an earlier past action.
          Example: ‚ÄúI had eaten before he arrived.‚Äù
          Your turn: Write 3 sentences using *had + past participle*.
