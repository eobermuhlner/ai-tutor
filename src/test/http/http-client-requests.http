###########################
### Authentication Examples
###########################

### Register New User
# @name register
POST {{host}}/api/v1/auth/register
Content-Type: application/json

{
  "username": "demouser",
  "email": "demo@example.com",
  "password": "DemoPassword123",
  "firstName": "Demo",
  "lastName": "User"
}

> {%
    client.global.set("userId", response.body.id);
%}

### Login User
# @name login
POST {{host}}/api/v1/auth/login
Content-Type: application/json

{
  "username": "demouser",
  "password": "DemoPassword123"
}

> {%
    client.global.set("accessToken", response.body.accessToken);
    client.global.set("refreshToken", response.body.refreshToken);
    client.global.set("userId", response.body.user.id);
%}

### Refresh Access Token
POST {{host}}/api/v1/auth/refresh
Content-Type: application/json

{
  "refreshToken": "{{refreshToken}}"
}

> {%
    client.global.set("accessToken", response.body.accessToken);
    client.global.set("refreshToken", response.body.refreshToken);
%}

### Get Current User Profile
GET {{host}}/api/v1/auth/me
Authorization: Bearer {{accessToken}}
Accept: application/json

### Change Password
POST {{host}}/api/v1/auth/password
Authorization: Bearer {{accessToken}}
Content-Type: application/json

{
  "currentPassword": "DemoPassword123",
  "newPassword": "NewDemoPassword456"
}

### Logout
POST {{host}}/api/v1/auth/logout
Authorization: Bearer {{accessToken}}

###

###########################
### Chat Session Examples
###########################

### Create Chat Session
# @name createSession
POST {{host}}/api/v1/chat/sessions
Authorization: Bearer {{accessToken}}
Content-Type: application/json

{
  "userId": "{{userId}}",
  "tutorName": "Maria",
  "tutorPersona": "patient coach",
  "tutorDomain": "general conversation, grammar, typography",
  "sourceLanguageCode": "en",
  "targetLanguageCode": "es",
  "conversationPhase": "Auto",
  "estimatedCEFRLevel": "A1"
}

> {%
    client.global.set("chatSessionId", response.body.id);
%}

### Get User Sessions
GET {{host}}/api/v1/chat/sessions?userId={{userId}}
Authorization: Bearer {{accessToken}}
Accept: application/json

### Get Session with Messages
GET {{host}}/api/v1/chat/sessions/{{chatSessionId}}
Authorization: Bearer {{accessToken}}
Accept: application/json

### Update Session Phase to Free (Pure fluency, no error tracking)
PATCH {{host}}/api/v1/chat/sessions/{{chatSessionId}}/phase
Authorization: Bearer {{accessToken}}
Content-Type: application/json

{
  "phase": "Free"
}

### Update Session Phase to Correction (Errors tracked for UI hover)
PATCH {{host}}/api/v1/chat/sessions/{{chatSessionId}}/phase
Authorization: Bearer {{accessToken}}
Content-Type: application/json

{
  "phase": "Correction"
}

### Update Session Phase to Drill (Explicit error work)
PATCH {{host}}/api/v1/chat/sessions/{{chatSessionId}}/phase
Authorization: Bearer {{accessToken}}
Content-Type: application/json

{
  "phase": "Drill"
}

### Update Session Phase to Auto (System decides)
PATCH {{host}}/api/v1/chat/sessions/{{chatSessionId}}/phase
Authorization: Bearer {{accessToken}}
Content-Type: application/json

{
  "phase": "Auto"
}

### Send Message (Non-Streaming)
POST {{host}}/api/v1/chat/sessions/{{chatSessionId}}/messages
Authorization: Bearer {{accessToken}}
Content-Type: application/json

{
  "content": "Hola, como estas?"
}

### Send Message (Non-Streaming)
POST {{host}}/api/v1/chat/sessions/{{chatSessionId}}/messages
Authorization: Bearer {{accessToken}}
Content-Type: application/json

{
  "content": "Hi, how are doing?"
}

### Send Message (Non-Streaming)
POST {{host}}/api/v1/chat/sessions/{{chatSessionId}}/messages
Authorization: Bearer {{accessToken}}
Content-Type: application/json

{
  "content": "Give me a list of vocabulary that I am learning."
}


### Send Message (Streaming with SSE)
POST {{host}}/api/v1/chat/sessions/{{chatSessionId}}/messages/stream
Authorization: Bearer {{accessToken}}
Content-Type: application/json

{
  "content": "Me gusta aprender espa√±ol"
}

### Update Session Topic
PATCH {{host}}/api/v1/chat/sessions/{{chatSessionId}}/topic
Authorization: Bearer {{accessToken}}
Content-Type: application/json

{
  "currentTopic": "travel"
}

### Get Topic History
GET {{host}}/api/v1/chat/sessions/{{chatSessionId}}/topics/history
Authorization: Bearer {{accessToken}}
Accept: application/json

### Delete Session
DELETE {{host}}/api/v1/chat/sessions/{{chatSessionId}}
Authorization: Bearer {{accessToken}}

###

###########################
### Vocabulary Examples
###########################

### Get User Vocabulary (All Languages)
GET {{host}}/api/v1/vocabulary?userId={{userId}}
Authorization: Bearer {{accessToken}}
Accept: application/json

### Get User Vocabulary (Specific Language)
GET {{host}}/api/v1/vocabulary?userId={{userId}}&lang=es
Authorization: Bearer {{accessToken}}
Accept: application/json

### Get Vocabulary Item with Contexts
# @name getVocabItem
GET {{host}}/api/v1/vocabulary/VOCABULARY_ITEM_ID
Authorization: Bearer {{accessToken}}
Accept: application/json

